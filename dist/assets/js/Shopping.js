import{r as i,m as F,g as V,a as u,c as p,h as m,d as s,i as w,b as e,n as $,f as T,t as _,E as U,G as E,F as B,k as M,H,I as J,J as W,l as q,D as Q,w as N,j}from"./index.js";import{e as x}from"./EventBus.js";import{$ as X}from"./jquery.js";import"./bootstrap.esm.js";import{_ as Y}from"./Pagination.js";const Z={class:"container position-relative"},ee={class:"row"},te={class:"col-12 border p-md-3 p-1"},oe={class:"d-flex mt-md-3 m-0 sticky-top SearchBox"},ae={class:"col-auto ps-md-3 ps-1"},se={class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},le={class:"btn-group",role:"group"},ne={class:"dropdown-menu py-2","aria-labelledby":"btnGroupDrop1"},re={class:"form-check"},ie=e("label",{class:"form-check-label",for:"'flexRadioDefault'"},"全部",-1),ce=["onClick"],de={class:"form-check"},ue=["id","value"],pe=["for"],_e={class:"search col-auto m-md-0 px-md-2 ps-1"},fe={class:"d-flex"},he={class:"d-flex flex-wrap align-items-stretch my-md-3 mx-0 my-3"},ge={class:"card border-1 shadow-sm height-100"},ve={class:"rounded-top hoverScale",style:{height:"150px"}},be={class:"card-body"},me={class:"badge border border-brown text-brown float-right mb-2"},ye={class:"card-title omit-1 fs-6 fw-normal"},we={class:"card-text omit-2"},xe={class:"d-flex"},ke={class:"col-6 text-decoration-line-through text-secondary"},Ce=e("span",null,"原價：",-1),De={class:"text-decoration-line-through"},Re={class:"col-6 text-danger"},Se=e("span",null,"特價：",-1),$e={class:"fs-5"},Te={class:"card-footer d-flex justify-content-center bg-brown p-1"},Ue={key:0,class:"fas fa-spinner fa-spin"},Be=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Ke=["disabled","onClick"],Le={key:0,class:"fas fa-spinner fa-spin"},Ve=e("i",{class:"fa-solid fa-cart-shopping"},null,-1),Ee={key:1},Ie={__name:"Shopping",setup(Me){window.$=X;let f=i(!1),c=i({productLoading:"",productChangeToCart:""});const g=i([]),v=i([]),k=i({}),K=i({});let C=i(8),l=i("全部"),h=i(""),d=i(""),b=i({price:!1,date:!1});function z(t){P(t),G(),D(),f.value=!1}function P(t){t.filter(a=>{a.is_enabled&&g.value.push(a)})}function G(){let t=new Set;g.value.forEach(a=>{let n=a.category.indexOf("star"),r=n>0?a.category.substring(0,n-1):a.category;t.add(r)}),K.value=t}function D(t="全部"){let a=[];l.value=t,t=="全部"?a=Object.assign([],g.value):(g.value.forEach(n=>{n.category==l.value&&a.push(n)}),d.value=""),v.value=a,y(1)}function L(){let t=[];d.value="",g.value.forEach(a=>{a.title.search(h.value)!=-1&&t.push(a)}),v.value=Object.assign([],t),y(1),h.value="",l.value=""}function y(t=1){let a=Math.ceil(v.value.length/C.value),n={total_pages:a,current_page:t,has_pre:t!==1,has_next:t!==a,category:null};x.emit("pagination:init",n),k.value=v.value.slice((t-1)*C.value,t*C.value)}function I(t){d.value=t,b.value[t]=!b.value[t],v.value.sort(function(r,o){var r=r[t],o=o[t];return r===null?1:o===null?-1:(r===o?0:r>o?1:-1)*(b.value.price?1:-1)}),y(1)}function O(){f.value=!0,q.get("https://vue-course-api.hexschool.io/api/ozeu/products/all").then(a=>{if(a.data.success){let n=a.data.products;z(n)}})}function A(t,a=1){c.value.productChangeToCart=t,x.emit("cart:change",[t,a])}return F(()=>{O(),x.on("pagination:chage",t=>{y(t)}),x.on("cart:success",t=>{t&&(c.value.productChangeToCart="")})}),(t,a)=>{const n=V("loading"),r=V("router-link");return u(),p(B,null,[m(n,{active:s(f),"onUpdate:active":a[0]||(a[0]=o=>w(f)?f.value=o:f=o)},null,8,["active"]),e("div",Z,[e("div",ee,[e("div",te,[e("div",oe,[e("div",ae,[e("div",se,[e("div",le,[e("button",{id:"btnGroupDrop1",type:"button",class:$(["btn dropdown-toggle",{"btn-brown":s(d)!="price","text-white":s(d)!="price","btn-outline-brown":s(d)=="price"}]),"data-bs-toggle":"dropdown","aria-expanded":"false"},[T(" 分類 "),e("span",null,"："+_(s(l)),1)],2),e("ul",ne,[e("li",{class:"dropdown-item px-3 py-1",onClick:a[2]||(a[2]=o=>D(t.item))},[e("div",re,[U(e("input",{class:"form-check-input text-brown",type:"radio",name:"flexRadioDefault",id:"'flexRadioDefault'",value:"全部","onUpdate:modelValue":a[1]||(a[1]=o=>w(l)?l.value=o:l=o)},null,512),[[E,s(l)]]),ie])]),(u(!0),p(B,null,M(K.value,(o,R)=>(u(),p("li",{class:"dropdown-item px-3 py-1",onClick:S=>D(o)},[e("div",de,[U(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault"+R,value:o,"onUpdate:modelValue":a[3]||(a[3]=S=>w(l)?l.value=S:l=S)},null,8,ue),[[E,s(l)]]),e("label",{class:"form-check-label",for:"flexRadioDefault"+R},_(o),9,pe)])],8,ce))),256))])]),e("button",{type:"button",class:$(["btn",{"btn-brown":s(d)=="price","btn-outline-brown":s(d)!="price"}]),onClick:a[4]||(a[4]=o=>I("price"))},[T(" 價格 "),e("i",{class:$(["fa-solid fa-arrow-down-wide-short",{"fa-arrow-down-wide-short":!s(b).price,"fa-arrow-down-short-wide":s(b).price}])},null,2)],2)])]),e("div",_e,[e("form",fe,[U(e("input",{class:"form-control border-brown",type:"search",placeholder:"輸入關鍵字","aria-label":"Search","onUpdate:modelValue":a[5]||(a[5]=o=>w(h)?h.value=o:h=o),onKeyup:J(L,["13"])},null,544),[[H,s(h)]]),e("button",{class:"btn btn-outline-brown d-md-block d-none ms-1",type:"submit",onClick:W(L,["prevent"])},"搜尋")])])]),e("div",he,[k.value.length>0?(u(!0),p(B,{key:0},M(k.value,o=>(u(),p("div",{class:"col-lg-3 col-md-3 col-sm-4 col-12 px-3 pb-3",key:o.id},[e("div",ge,[e("div",ve,[m(r,{class:"d-block hoverScale-img",to:"/page/"+o.id,style:Q([{"background-size":"cover","background-position":"center"},{"background-image":`url(${o.imageUrl})`}])},null,8,["to","style"])]),e("div",be,[e("span",me,_(t.$mydata.filterKeyWord(o.category)),1),e("p",ye,[m(r,{to:"/page/"+o.id,class:"text-dark text-decoration-none"},{default:N(()=>[T(_(o.title),1)]),_:2},1032,["to"])]),e("p",we,_(o.content),1),e("div",xe,[e("div",ke,[Ce,e("span",De,_(t.$currency.currencyUSD(o.origin_price)),1)]),e("div",Re,[Se,e("span",$e,_(t.$currency.currencyUSD(o.price)),1)])])]),e("div",Te,[m(r,{to:"/page/"+o.id,type:"button",class:"btn btn-outline-gold btn-sm me-3",disabled:s(c).productChangeToCart||s(c).productLoading==o.id},{default:N(()=>[s(c).productLoading==o.id?(u(),p("i",Ue)):j("",!0),Be]),_:2},1032,["to","disabled"]),e("button",{type:"button",class:"btn btn-outline-gold btn-sm ml-auto",disabled:s(c).productChangeToCart||s(c).productLoading==o.id,onClick:R=>A(o.id)},[s(c).productChangeToCart==o.id?(u(),p("i",Le)):j("",!0),Ve],8,Ke)])])]))),128)):(u(),p("div",Ee," 沒有符合的產品 ")),m(Y)])])])])],64)}}};export{Ie as default};
