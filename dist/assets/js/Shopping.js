import{r as n,m as A,g as V,a as u,c as p,h as w,d as a,i as y,b as e,n as T,f as E,t as _,B as $,C as M,F as B,k as N,D as H,E as I,G as q,l as J,H as Q,w as W,j}from"./index.js";import{e as x}from"./EventBus.js";import{$ as X}from"./jquery.js";import"./bootstrap.esm.js";import{_ as Y}from"./Pagination.js";const Z={class:"container position-relative"},ee={class:"row"},te={class:"col-12 border-start p-md-3 p-1"},oe={class:"d-flex mt-md-3 m-0 sticky-top SearchBox"},se={class:"col-auto ps-md-3 ps-1"},ae={class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},le={class:"btn-group",role:"group"},ne={class:"dropdown-menu py-2","aria-labelledby":"btnGroupDrop1"},ie={class:"form-check"},re=e("label",{class:"form-check-label",for:"'flexRadioDefault'"},"全部",-1),ce=["onClick"],de={class:"form-check"},ue=["id","value"],pe=["for"],_e={class:"search col-auto m-md-0 px-md-2 ps-1"},fe={class:"d-flex"},he={class:"d-flex flex-wrap align-items-stretch my-md-3 mx-0 my-3"},ve={class:"card border-1 shadow-sm height-100"},ge={class:"rounded-top hoverScale",style:{height:"150px"}},be={class:"card-body"},me={class:"badge border border-brown text-brown float-right mb-2"},we={class:"card-title omit-1 fs-6 fw-normal"},ye={href:"",class:"text-dark text-decoration-none"},xe={class:"card-text omit-2"},ke={class:"d-flex"},Ce={class:"col-6 text-decoration-line-through text-secondary"},De=e("span",null,"原價：",-1),Re={class:"text-decoration-line-through"},Se={class:"col-6 text-danger"},Te=e("span",null,"特價：",-1),$e={class:"fs-5"},Be={class:"card-footer d-flex justify-content-center bg-brown p-1"},Ue={key:0,class:"fas fa-spinner fa-spin"},Le=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Ve=["disabled","onClick"],Ee={key:0,class:"fas fa-spinner fa-spin"},Me=e("i",{class:"fa-solid fa-cart-shopping"},null,-1),Ne={key:1},Oe={__name:"Shopping",setup(je){window.$=X;let f=n(!1),r=n({productLoading:"",productChangeToCart:""});const v=n([]),g=n([]),k=n({}),U=n({});let C=n(8),l=n("全部"),h=n(""),c=n(""),b=n({price:!1,date:!1});function z(t){K(t),U.value=P(),D(),f.value=!1}function K(t){t.filter(s=>{s.is_enabled&&v.value.push(s)})}function P(){var t=new Set;return v.value.forEach(s=>{t.add(s.category)}),t}function D(t="全部"){let s=[];l.value=t,t=="全部"?s=Object.assign([],v.value):(v.value.forEach(i=>{i.category==l.value&&s.push(i)}),c.value=""),g.value=s,m(1)}function L(){let t=[];c.value="",v.value.forEach(s=>{s.title.search(h.value)!=-1&&t.push(s)}),g.value=Object.assign([],t),m(1),h.value="",l.value=""}function m(t=1){let s=Math.ceil(g.value.length/C.value),i={total_pages:s,current_page:t,has_pre:t!==1,has_next:t!==s,category:null};x.emit("pagination:init",i),k.value=g.value.slice((t-1)*C.value,t*C.value)}function G(t){c.value=t,b.value[t]=!b.value[t],g.value.sort(function(d,o){var d=d[t],o=o[t];return d===null?1:o===null?-1:(d===o?0:d>o?1:-1)*(b.value.price?1:-1)}),m(1)}function F(){f.value=!0,J.get("https://vue-course-api.hexschool.io/api/ozeu/products/all").then(s=>{if(s.data.success){let i=s.data.products;z(i)}})}function O(t,s=1){r.value.productChangeToCart=t,x.emit("cart:change",[t,s])}return A(()=>{F(),x.on("pagination:chage",t=>{m(t)}),x.on("cart:success",t=>{t&&(r.value.productChangeToCart="")})}),(t,s)=>{const i=V("loading"),d=V("router-link");return u(),p(B,null,[w(i,{active:a(f),"onUpdate:active":s[0]||(s[0]=o=>y(f)?f.value=o:f=o)},null,8,["active"]),e("div",Z,[e("div",ee,[e("div",te,[e("div",oe,[e("div",se,[e("div",ae,[e("div",le,[e("button",{id:"btnGroupDrop1",type:"button",class:T(["btn dropdown-toggle",{"btn-brown":a(c)!="price","text-white":a(c)!="price","btn-outline-brown":a(c)=="price"}]),"data-bs-toggle":"dropdown","aria-expanded":"false"},[E(" 分類 "),e("span",null,"："+_(a(l)),1)],2),e("ul",ne,[e("li",{class:"dropdown-item px-3 py-1",onClick:s[2]||(s[2]=o=>D(t.item))},[e("div",ie,[$(e("input",{class:"form-check-input text-brown",type:"radio",name:"flexRadioDefault",id:"'flexRadioDefault'",value:"全部","onUpdate:modelValue":s[1]||(s[1]=o=>y(l)?l.value=o:l=o)},null,512),[[M,a(l)]]),re])]),(u(!0),p(B,null,N(U.value,(o,R)=>(u(),p("li",{class:"dropdown-item px-3 py-1",onClick:S=>D(o)},[e("div",de,[$(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault"+R,value:o,"onUpdate:modelValue":s[3]||(s[3]=S=>y(l)?l.value=S:l=S)},null,8,ue),[[M,a(l)]]),e("label",{class:"form-check-label",for:"flexRadioDefault"+R},_(o),9,pe)])],8,ce))),256))])]),e("button",{type:"button",class:T(["btn",{"btn-brown":a(c)=="price","btn-outline-brown":a(c)!="price"}]),onClick:s[4]||(s[4]=o=>G("price"))},[E(" 價格 "),e("i",{class:T(["fa-solid fa-arrow-down-wide-short",{"fa-arrow-down-wide-short":!a(b).price,"fa-arrow-down-short-wide":a(b).price}])},null,2)],2)])]),e("div",_e,[e("form",fe,[$(e("input",{class:"form-control border-brown",type:"search",placeholder:"輸入關鍵字","aria-label":"Search","onUpdate:modelValue":s[5]||(s[5]=o=>y(h)?h.value=o:h=o),onKeyup:I(L,["13"])},null,544),[[H,a(h)]]),e("button",{class:"btn btn-outline-brown d-md-block d-none ms-1",type:"submit",onClick:q(L,["prevent"])},"搜尋")])])]),e("div",he,[k.value.length>0?(u(!0),p(B,{key:0},N(k.value,o=>(u(),p("div",{class:"col-lg-3 col-md-3 col-sm-4 col-12 px-3 pb-3",key:o.id},[e("div",ve,[e("div",ge,[w(d,{class:"d-block hoverScale-img",to:"/page/"+o.id,style:Q([{"background-size":"cover","background-position":"center"},{"background-image":`url(${o.imageUrl})`}])},null,8,["to","style"])]),e("div",be,[e("span",me,_(o.category),1),e("p",we,[e("a",ye,_(o.title),1)]),e("p",xe,_(o.content),1),e("div",ke,[e("div",Ce,[De,e("span",Re,_(t.$currency.currencyUSD(o.origin_price)),1)]),e("div",Se,[Te,e("span",$e,_(t.$currency.currencyUSD(o.price)),1)])])]),e("div",Be,[w(d,{to:"/page/"+o.id,type:"button",class:"btn btn-outline-gold btn-sm me-3",disabled:a(r).productChangeToCart||a(r).productLoading==o.id},{default:W(()=>[a(r).productLoading==o.id?(u(),p("i",Ue)):j("",!0),Le]),_:2},1032,["to","disabled"]),e("button",{type:"button",class:"btn btn-outline-gold btn-sm ml-auto",disabled:a(r).productChangeToCart||a(r).productLoading==o.id,onClick:R=>O(o.id)},[a(r).productChangeToCart==o.id?(u(),p("i",Ee)):j("",!0),Me],8,Ve)])])]))),128)):(u(),p("div",Ne," 沒有符合的產品 ")),w(Y)])])])])],64)}}};export{Oe as default};
