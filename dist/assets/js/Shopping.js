import{d as n,m as O,e as V,a as d,c as u,f as y,g as s,i as w,b as e,A as T,h as E,t as _,B as $,C as M,F as B,k as N,D as H,E as I,G as q,l as J,H as Q,w as W,j}from"./index.js";import{e as k}from"./EventBus.js";import{$ as X}from"./jquery.js";import"./bootstrap.esm.js";import{_ as Y}from"./Pagination.js";const Z={class:"container position-relative"},ee={class:"row"},te={class:"col-12 border-start p-1"},oe={class:"row mt-md-2 m-0 sticky-top SearchBox"},ae={class:"col-auto"},se={class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},le={class:"btn-group",role:"group"},ne={class:"dropdown-menu","aria-labelledby":"btnGroupDrop1"},ie={class:"form-check"},re=e("label",{class:"form-check-label",for:"'flexRadioDefault'"},"全部",-1),ce=["onClick"],de={class:"form-check"},ue=["id","value"],pe=["for"],_e={class:"search col-auto m-md-0 p-0"},fe={class:"d-flex"},he={class:"row align-items-stretch m-md-2 m-0"},ve={class:"card border-1 shadow-sm height-100"},ge={class:"rounded-top hoverScale",style:{height:"150px"}},me={class:"card-body"},be={class:"badge border border-primary text-primary float-right mb-2"},ye={class:"card-title omit-1 fs-6 fw-normal"},we={href:"",class:"text-dark text-decoration-none"},ke={class:"card-text omit-2"},Ce={class:"d-flex"},xe={class:"col-6 text-decoration-line-through text-secondary"},De=e("span",null,"原價：",-1),Re={class:"text-decoration-line-through"},Se={class:"col-6 text-danger"},Te=e("span",null,"特價：",-1),$e={class:"fs-5"},Be={class:"card-footer d-flex justify-content-center p-1"},Ue={key:0,class:"fas fa-spinner fa-spin"},Le=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Ve=["disabled","onClick"],Ee={key:0,class:"fas fa-spinner fa-spin"},Me=e("i",{class:"fa-solid fa-cart-shopping"},null,-1),Ne={key:1},Fe={__name:"Shopping",setup(je){window.$=X;let f=n(!1),r=n({productLoading:"",productChangeToCart:""});const v=n([]),g=n([]),C=n({}),U=n({});let x=n(8),l=n("全部"),h=n(""),p=n(""),m=n({price:!1,date:!1});function z(t){K(t),U.value=P(),D(),f.value=!1}function K(t){t.filter(a=>{a.is_enabled&&v.value.push(a)})}function P(){var t=new Set;return v.value.forEach(a=>{t.add(a.category)}),t}function D(t="全部"){let a=[];l.value=t,t=="全部"?a=Object.assign([],v.value):(v.value.forEach(i=>{i.category==l.value&&a.push(i)}),p.value=""),g.value=a,b(1)}function L(){let t=[];p.value="",v.value.forEach(a=>{a.title.search(h.value)!=-1&&t.push(a)}),g.value=Object.assign([],t),b(1),h.value="",l.value=""}function b(t=1){let a=Math.ceil(g.value.length/x.value),i={total_pages:a,current_page:t,has_pre:t!==1,has_next:t!==a,category:null};k.emit("pagination:init",i),C.value=g.value.slice((t-1)*x.value,t*x.value)}function G(t){p.value=t,m.value[t]=!m.value[t],g.value.sort(function(c,o){var c=c[t],o=o[t];return c===null?1:o===null?-1:(c===o?0:c>o?1:-1)*(m.value.price?1:-1)}),b(1)}function A(){f.value=!0,J.get("https://vue-course-api.hexschool.io/api/ozeu/products/all").then(a=>{if(a.data.success){let i=a.data.products;z(i)}})}function F(t,a=1){r.value.productChangeToCart=t,k.emit("cart:change",[t,a])}return O(()=>{A(),k.on("pagination:chage",t=>{b(t)}),k.on("cart:success",t=>{t&&(r.value.productChangeToCart="")})}),(t,a)=>{const i=V("loading"),c=V("router-link");return d(),u(B,null,[y(i,{active:s(f),"onUpdate:active":a[0]||(a[0]=o=>w(f)?f.value=o:f=o)},null,8,["active"]),e("div",Z,[e("div",ee,[e("div",te,[e("div",oe,[e("div",ae,[e("div",se,[e("div",le,[e("button",{id:"btnGroupDrop1",type:"button",class:T(["btn dropdown-toggle",{"btn-primary":s(p)=="","btn-outline-primary":s(p)!=""}]),"data-bs-toggle":"dropdown","aria-expanded":"false"},[E(" 分類 "),e("span",null,"："+_(s(l)),1)],2),e("ul",ne,[e("li",{class:"dropdown-item",onClick:a[2]||(a[2]=o=>D(t.item))},[e("div",ie,[$(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"'flexRadioDefault'",value:"全部","onUpdate:modelValue":a[1]||(a[1]=o=>w(l)?l.value=o:l=o)},null,512),[[M,s(l)]]),re])]),(d(!0),u(B,null,N(U.value,(o,R)=>(d(),u("li",{class:"dropdown-item",onClick:S=>D(o)},[e("div",de,[$(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault"+R,value:o,"onUpdate:modelValue":a[3]||(a[3]=S=>w(l)?l.value=S:l=S)},null,8,ue),[[M,s(l)]]),e("label",{class:"form-check-label",for:"flexRadioDefault"+R},_(o),9,pe)])],8,ce))),256))])]),e("button",{type:"button",class:T(["btn",{"btn-primary":s(p)=="price","btn-outline-primary":s(p)!="price"}]),onClick:a[4]||(a[4]=o=>G("price"))},[E(" 價格 "),e("i",{class:T(["fa-solid fa-arrow-down-wide-short",{"fa-arrow-down-wide-short":!s(m).price,"fa-arrow-down-short-wide":s(m).price}])},null,2)],2)])]),e("div",_e,[e("form",fe,[$(e("input",{class:"form-control",type:"search",placeholder:"輸入關鍵字","aria-label":"Search","onUpdate:modelValue":a[5]||(a[5]=o=>w(h)?h.value=o:h=o),onKeyup:I(L,["13"])},null,544),[[H,s(h)]]),e("button",{class:"btn btn-outline-success d-md-block d-none ms-1",type:"submit",onClick:q(L,["prevent"])},"搜尋")])])]),e("div",he,[C.value.length>0?(d(!0),u(B,{key:0},N(C.value,o=>(d(),u("div",{class:"col-lg-3 col-md-3 col-sm-4 col-6 mb-4 p-1",key:o.id},[e("div",ve,[e("div",ge,[y(c,{class:"d-block hoverScale-img",to:"/page/"+o.id,style:Q([{"background-size":"cover","background-position":"center"},{"background-image":`url(${o.imageUrl})`}])},null,8,["to","style"])]),e("div",me,[e("span",be,_(o.category),1),e("p",ye,[e("a",we,_(o.title),1)]),e("p",ke,_(o.content),1),e("div",Ce,[e("div",xe,[De,e("span",Re,_(t.$currency.currencyUSD(o.origin_price)),1)]),e("div",Se,[Te,e("span",$e,_(t.$currency.currencyUSD(o.price)),1)])])]),e("div",Be,[y(c,{to:"/page/"+o.id,type:"button",class:"btn btn-outline-secondary btn-sm me-3",disabled:s(r).productChangeToCart||s(r).productLoading==o.id},{default:W(()=>[s(r).productLoading==o.id?(d(),u("i",Ue)):j("",!0),Le]),_:2},1032,["to","disabled"]),e("button",{type:"button",class:"btn btn-outline-danger btn-sm ml-auto",disabled:s(r).productChangeToCart||s(r).productLoading==o.id,onClick:R=>F(o.id)},[s(r).productChangeToCart==o.id?(d(),u("i",Ee)):j("",!0),Me],8,Ve)])])]))),128)):(d(),u("div",Ne," 沒有符合的產品 ")),y(Y)])])])])],64)}}};export{Fe as default};
