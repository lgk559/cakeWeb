import{d as n,m as H,e as P,a as d,c as u,f as y,g as s,i as w,b as e,A as T,h as $,t as _,B as E,C as L,F as U,k as M,D as F,E as q,G as J,l as Q,H as W,w as X,j as A}from"./index.js";import{e as k}from"./EventBus.js";import{$ as Y}from"./jquery.js";import"./bootstrap.esm.js";import{_ as Z}from"./Pagination.js";var N={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ee={class:"container position-relative"},te={class:"row"},oe={class:"col-12 border-start p-1"},ae={class:"row mt-md-2 m-0 sticky-top SearchBox"},se={class:"col-auto"},le={class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},ne={class:"btn-group",role:"group"},ie={class:"dropdown-menu","aria-labelledby":"btnGroupDrop1"},re={class:"form-check"},ce=e("label",{class:"form-check-label",for:"'flexRadioDefault'"},"全部",-1),de=["onClick"],ue={class:"form-check"},pe=["id","value"],_e=["for"],fe={class:"search col-auto m-md-0 p-0"},he={class:"d-flex"},ve={class:"row align-items-stretch m-md-2 m-0"},ge={class:"card border-1 shadow-sm height-100"},me={class:"rounded-top hoverScale",style:{height:"150px"}},be={class:"card-body"},ye={class:"badge border border-primary text-primary float-right mb-2"},we={class:"card-title omit-1 fs-6 fw-normal"},ke={href:"",class:"text-dark text-decoration-none"},Ce={class:"card-text omit-2"},xe={class:"d-flex"},De={class:"col-6 text-decoration-line-through text-secondary"},Se=e("span",null,"原價：",-1),Re={class:"text-decoration-line-through"},Te={class:"col-6 text-danger"},Ee=e("span",null,"特價：",-1),Ue={class:"fs-5"},Ve={class:"card-footer d-flex justify-content-center p-1"},Be={key:0,class:"fas fa-spinner fa-spin"},Pe=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),$e=["disabled","onClick"],Le={key:0,class:"fas fa-spinner fa-spin"},Me=e("i",{class:"fa-solid fa-cart-shopping"},null,-1),Ae={key:1},Ge={__name:"Shopping",setup(Ne){window.$=Y;let f=n(!1),r=n({productLoading:"",productChangeToCart:""});const v=n([]),g=n([]),C=n({}),V=n({});let x=n(8),l=n("全部"),h=n(""),p=n(""),m=n({price:!1,date:!1});function O(t){j(t),V.value=I(),D(),f.value=!1}function j(t){t.filter(a=>{a.is_enabled&&v.value.push(a)})}function I(){var t=new Set;return v.value.forEach(a=>{t.add(a.category)}),t}function D(t="全部"){let a=[];l.value=t,t=="全部"?a=Object.assign([],v.value):(v.value.forEach(i=>{i.category==l.value&&a.push(i)}),p.value=""),g.value=a,b(1)}function B(){let t=[];p.value="",v.value.forEach(a=>{a.title.search(h.value)!=-1&&t.push(a)}),g.value=Object.assign([],t),b(1),h.value="",l.value=""}function b(t=1){let a=Math.ceil(g.value.length/x.value),i={total_pages:a,current_page:t,has_pre:t!==1,has_next:t!==a,category:null};k.emit("pagination:init",i),C.value=g.value.slice((t-1)*x.value,t*x.value)}function K(t){p.value=t,m.value[t]=!m.value[t],g.value.sort(function(c,o){var c=c[t],o=o[t];return c===null?1:o===null?-1:(c===o?0:c>o?1:-1)*(m.value.price?1:-1)}),b(1)}function z(){f.value=!0;const t=`${N.VITE_APIPATH}/api/${N.VITE_CUSTOMPATH}/products/all`;Q.get(t).then(a=>{if(a.data.success){let i=a.data.products;O(i)}})}function G(t,a=1){r.value.productChangeToCart=t,k.emit("cart:change",[t,a])}return H(()=>{z(),k.on("pagination:chage",t=>{b(t)}),k.on("cart:success",t=>{t&&(r.value.productChangeToCart="")})}),(t,a)=>{const i=P("loading"),c=P("router-link");return d(),u(U,null,[y(i,{active:s(f),"onUpdate:active":a[0]||(a[0]=o=>w(f)?f.value=o:f=o)},null,8,["active"]),e("div",ee,[e("div",te,[e("div",oe,[e("div",ae,[e("div",se,[e("div",le,[e("div",ne,[e("button",{id:"btnGroupDrop1",type:"button",class:T(["btn dropdown-toggle",{"btn-primary":s(p)=="","btn-outline-primary":s(p)!=""}]),"data-bs-toggle":"dropdown","aria-expanded":"false"},[$(" 分類 "),e("span",null,"："+_(s(l)),1)],2),e("ul",ie,[e("li",{class:"dropdown-item",onClick:a[2]||(a[2]=o=>D(t.item))},[e("div",re,[E(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"'flexRadioDefault'",value:"全部","onUpdate:modelValue":a[1]||(a[1]=o=>w(l)?l.value=o:l=o)},null,512),[[L,s(l)]]),ce])]),(d(!0),u(U,null,M(V.value,(o,S)=>(d(),u("li",{class:"dropdown-item",onClick:R=>D(o)},[e("div",ue,[E(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault"+S,value:o,"onUpdate:modelValue":a[3]||(a[3]=R=>w(l)?l.value=R:l=R)},null,8,pe),[[L,s(l)]]),e("label",{class:"form-check-label",for:"flexRadioDefault"+S},_(o),9,_e)])],8,de))),256))])]),e("button",{type:"button",class:T(["btn",{"btn-primary":s(p)=="price","btn-outline-primary":s(p)!="price"}]),onClick:a[4]||(a[4]=o=>K("price"))},[$(" 價格 "),e("i",{class:T(["fa-solid fa-arrow-down-wide-short",{"fa-arrow-down-wide-short":!s(m).price,"fa-arrow-down-short-wide":s(m).price}])},null,2)],2)])]),e("div",fe,[e("form",he,[E(e("input",{class:"form-control",type:"search",placeholder:"輸入關鍵字","aria-label":"Search","onUpdate:modelValue":a[5]||(a[5]=o=>w(h)?h.value=o:h=o),onKeyup:q(B,["13"])},null,544),[[F,s(h)]]),e("button",{class:"btn btn-outline-success d-md-block d-none ms-1",type:"submit",onClick:J(B,["prevent"])},"搜尋")])])]),e("div",ve,[C.value.length>0?(d(!0),u(U,{key:0},M(C.value,o=>(d(),u("div",{class:"col-lg-3 col-md-3 col-sm-4 col-6 mb-4 p-1",key:o.id},[e("div",ge,[e("div",me,[y(c,{class:"d-block hoverScale-img",to:"/page/"+o.id,style:W([{"background-size":"cover","background-position":"center"},{"background-image":`url(${o.imageUrl})`}])},null,8,["to","style"])]),e("div",be,[e("span",ye,_(o.category),1),e("p",we,[e("a",ke,_(o.title),1)]),e("p",Ce,_(o.content),1),e("div",xe,[e("div",De,[Se,e("span",Re,_(t.$currency.currencyUSD(o.origin_price)),1)]),e("div",Te,[Ee,e("span",Ue,_(t.$currency.currencyUSD(o.price)),1)])])]),e("div",Ve,[y(c,{to:"/page/"+o.id,type:"button",class:"btn btn-outline-secondary btn-sm me-3",disabled:s(r).productChangeToCart||s(r).productLoading==o.id},{default:X(()=>[s(r).productLoading==o.id?(d(),u("i",Be)):A("",!0),Pe]),_:2},1032,["to","disabled"]),e("button",{type:"button",class:"btn btn-outline-danger btn-sm ml-auto",disabled:s(r).productChangeToCart||s(r).productLoading==o.id,onClick:S=>G(o.id)},[s(r).productChangeToCart==o.id?(d(),u("i",Le)):A("",!0),Me],8,$e)])])]))),128)):(d(),u("div",Ae," 沒有符合的產品 ")),y(Z)])])])])],64)}}};export{Ge as default};
