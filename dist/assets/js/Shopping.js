import{r as n,m as H,g as E,a as u,c as p,h as m,d as s,i as y,b as e,n as T,f as $,t as _,B,C as M,F as U,k as N,D as I,E as q,G as J,l as Q,H as W,w as j,j as z}from"./index.js";import{e as x}from"./EventBus.js";import{$ as X}from"./jquery.js";import"./bootstrap.esm.js";import{_ as Y}from"./Pagination.js";const Z={class:"container position-relative"},ee={class:"row"},te={class:"col-12 border p-md-3 p-1"},oe={class:"d-flex mt-md-3 m-0 sticky-top SearchBox"},ae={class:"col-auto ps-md-3 ps-1"},se={class:"btn-group",role:"group","aria-label":"Button group with nested dropdown"},le={class:"btn-group",role:"group"},ne={class:"dropdown-menu py-2","aria-labelledby":"btnGroupDrop1"},ie={class:"form-check"},re=e("label",{class:"form-check-label",for:"'flexRadioDefault'"},"全部",-1),ce=["onClick"],de={class:"form-check"},ue=["id","value"],pe=["for"],_e={class:"search col-auto m-md-0 px-md-2 ps-1"},fe={class:"d-flex"},he={class:"d-flex flex-wrap align-items-stretch my-md-3 mx-0 my-3"},ve={class:"card border-1 shadow-sm height-100"},ge={class:"rounded-top hoverScale",style:{height:"150px"}},be={class:"card-body"},me={class:"badge border border-brown text-brown float-right mb-2"},we={class:"card-title omit-1 fs-6 fw-normal"},ye={class:"card-text omit-2"},xe={class:"d-flex"},ke={class:"col-6 text-decoration-line-through text-secondary"},Ce=e("span",null,"原價：",-1),De={class:"text-decoration-line-through"},Re={class:"col-6 text-danger"},Se=e("span",null,"特價：",-1),Te={class:"fs-5"},$e={class:"card-footer d-flex justify-content-center bg-brown p-1"},Be={key:0,class:"fas fa-spinner fa-spin"},Ue=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Le=["disabled","onClick"],Ve={key:0,class:"fas fa-spinner fa-spin"},Ee=e("i",{class:"fa-solid fa-cart-shopping"},null,-1),Me={key:1},Fe={__name:"Shopping",setup(Ne){window.$=X;let f=n(!1),c=n({productLoading:"",productChangeToCart:""});const v=n([]),g=n([]),k=n({}),L=n({});let C=n(8),l=n("全部"),h=n(""),d=n(""),b=n({price:!1,date:!1});function K(t){P(t),L.value=G(),D(),f.value=!1}function P(t){t.filter(a=>{a.is_enabled&&v.value.push(a)})}function G(){var t=new Set;return v.value.forEach(a=>{t.add(a.category)}),t}function D(t="全部"){let a=[];l.value=t,t=="全部"?a=Object.assign([],v.value):(v.value.forEach(i=>{i.category==l.value&&a.push(i)}),d.value=""),g.value=a,w(1)}function V(){let t=[];d.value="",v.value.forEach(a=>{a.title.search(h.value)!=-1&&t.push(a)}),g.value=Object.assign([],t),w(1),h.value="",l.value=""}function w(t=1){let a=Math.ceil(g.value.length/C.value),i={total_pages:a,current_page:t,has_pre:t!==1,has_next:t!==a,category:null};x.emit("pagination:init",i),k.value=g.value.slice((t-1)*C.value,t*C.value)}function F(t){d.value=t,b.value[t]=!b.value[t],g.value.sort(function(r,o){var r=r[t],o=o[t];return r===null?1:o===null?-1:(r===o?0:r>o?1:-1)*(b.value.price?1:-1)}),w(1)}function O(){f.value=!0,Q.get("https://vue-course-api.hexschool.io/api/ozeu/products/all").then(a=>{if(a.data.success){let i=a.data.products;K(i)}})}function A(t,a=1){c.value.productChangeToCart=t,x.emit("cart:change",[t,a])}return H(()=>{O(),x.on("pagination:chage",t=>{w(t)}),x.on("cart:success",t=>{t&&(c.value.productChangeToCart="")})}),(t,a)=>{const i=E("loading"),r=E("router-link");return u(),p(U,null,[m(i,{active:s(f),"onUpdate:active":a[0]||(a[0]=o=>y(f)?f.value=o:f=o)},null,8,["active"]),e("div",Z,[e("div",ee,[e("div",te,[e("div",oe,[e("div",ae,[e("div",se,[e("div",le,[e("button",{id:"btnGroupDrop1",type:"button",class:T(["btn dropdown-toggle",{"btn-brown":s(d)!="price","text-white":s(d)!="price","btn-outline-brown":s(d)=="price"}]),"data-bs-toggle":"dropdown","aria-expanded":"false"},[$(" 分類 "),e("span",null,"："+_(s(l)),1)],2),e("ul",ne,[e("li",{class:"dropdown-item px-3 py-1",onClick:a[2]||(a[2]=o=>D(t.item))},[e("div",ie,[B(e("input",{class:"form-check-input text-brown",type:"radio",name:"flexRadioDefault",id:"'flexRadioDefault'",value:"全部","onUpdate:modelValue":a[1]||(a[1]=o=>y(l)?l.value=o:l=o)},null,512),[[M,s(l)]]),re])]),(u(!0),p(U,null,N(L.value,(o,R)=>(u(),p("li",{class:"dropdown-item px-3 py-1",onClick:S=>D(o)},[e("div",de,[B(e("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault"+R,value:o,"onUpdate:modelValue":a[3]||(a[3]=S=>y(l)?l.value=S:l=S)},null,8,ue),[[M,s(l)]]),e("label",{class:"form-check-label",for:"flexRadioDefault"+R},_(o),9,pe)])],8,ce))),256))])]),e("button",{type:"button",class:T(["btn",{"btn-brown":s(d)=="price","btn-outline-brown":s(d)!="price"}]),onClick:a[4]||(a[4]=o=>F("price"))},[$(" 價格 "),e("i",{class:T(["fa-solid fa-arrow-down-wide-short",{"fa-arrow-down-wide-short":!s(b).price,"fa-arrow-down-short-wide":s(b).price}])},null,2)],2)])]),e("div",_e,[e("form",fe,[B(e("input",{class:"form-control border-brown",type:"search",placeholder:"輸入關鍵字","aria-label":"Search","onUpdate:modelValue":a[5]||(a[5]=o=>y(h)?h.value=o:h=o),onKeyup:q(V,["13"])},null,544),[[I,s(h)]]),e("button",{class:"btn btn-outline-brown d-md-block d-none ms-1",type:"submit",onClick:J(V,["prevent"])},"搜尋")])])]),e("div",he,[k.value.length>0?(u(!0),p(U,{key:0},N(k.value,o=>(u(),p("div",{class:"col-lg-3 col-md-3 col-sm-4 col-12 px-3 pb-3",key:o.id},[e("div",ve,[e("div",ge,[m(r,{class:"d-block hoverScale-img",to:"/page/"+o.id,style:W([{"background-size":"cover","background-position":"center"},{"background-image":`url(${o.imageUrl})`}])},null,8,["to","style"])]),e("div",be,[e("span",me,_(o.category),1),e("p",we,[m(r,{to:"/page/"+o.id,class:"text-dark text-decoration-none"},{default:j(()=>[$(_(o.title),1)]),_:2},1032,["to"])]),e("p",ye,_(o.content),1),e("div",xe,[e("div",ke,[Ce,e("span",De,_(t.$currency.currencyUSD(o.origin_price)),1)]),e("div",Re,[Se,e("span",Te,_(t.$currency.currencyUSD(o.price)),1)])])]),e("div",$e,[m(r,{to:"/page/"+o.id,type:"button",class:"btn btn-outline-gold btn-sm me-3",disabled:s(c).productChangeToCart||s(c).productLoading==o.id},{default:j(()=>[s(c).productLoading==o.id?(u(),p("i",Be)):z("",!0),Ue]),_:2},1032,["to","disabled"]),e("button",{type:"button",class:"btn btn-outline-gold btn-sm ml-auto",disabled:s(c).productChangeToCart||s(c).productLoading==o.id,onClick:R=>A(o.id)},[s(c).productChangeToCart==o.id?(u(),p("i",Ve)):z("",!0),Ee],8,Le)])])]))),128)):(u(),p("div",Me," 沒有符合的產品 ")),m(Y)])])])])],64)}}};export{Fe as default};
