import{u as S,o as D,a as r,c as i,b as t,r as B,d as g,e as k,f as n,g as d,i as R,h as u,t as h,j as U,F as N,k as V,w as m,l as $,m as A}from"./index.js";import{M as E}from"./bootstrap.esm.js";import{$ as L}from"./jquery.js";import{e as y}from"./EventBus.js";import{_ as F}from"./AlertMessage2.js";const I={class:"fixed-top navbar navbar-dark navbar-expand-lg bg-brown text-gold"},H={class:"container-fluid justify-content-lg-center justify-content-md-between"},O=t("a",{class:"navbar-brand text-gold",href:"#"},"Navbar",-1),P=t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),W={class:"collapse navbar-collapse flex-grow-0",id:"navbarSupportedContent"},X={class:"navbar-nav me-auto ps-3 mb-2 mb-lg-0"},G={__name:"Navbar_customer",setup(w){return S(),window.$=L,D(()=>{}),(a,b)=>(r(),i("nav",I,[t("div",H,[O,P,t("div",W,[t("ul",X,[B(a.$slots,"default")])])])]))}},J={key:0,class:"d-flex text-gold position-fixed",id:"cart"},K={type:"button",class:"nav-iteme"},Q=t("i",{class:"fa-solid fa-cart-shopping"},null,-1),Y={class:"position-absolute start-100 translate-middle badge rounded-pill bg-danger"},Z=t("span",{class:"visually-hidden"},"unread messages",-1),tt={class:"modal-dialog w-md-auto w-100 mx-sm-auto mx-0",role:"document"},et={class:"modal-content border-0"},ot=t("div",{class:"modal-header bg-custom text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"您目前的購物車品項")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),at={class:"modal-body"},st={class:"table table-striped"},nt=t("thead",null,[t("tr",null,[t("td",{class:"col text-nowrap"},"管理"),t("td",{class:"col"},"品名"),t("td",{class:"col"},"數量"),t("td",{class:"col d-md-table-cell d-none"},"單價"),t("td",{class:"col d-md-table-cell d-none"},"小計")])],-1),lt={key:"item.id"},ct={class:"col"},dt=["onClick"],rt={key:0,class:"fas fa-spinner fa-spin"},it={key:1,class:"p"},ut={class:"col"},_t={class:"p omit-1"},pt={class:"col d-flex"},ht=["disabled","onClick"],mt=["value","onChange"],bt=["onClick"],ft={class:"col d-md-table-cell d-none"},vt={class:"col d-md-table-cell d-none"},gt=t("hr",null,null,-1),yt={class:"row justify-content-end pe-3"},xt={class:"col-auto"},Ct={class:"modal-footer"},$t=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"繼續購買",-1),kt={__name:"cart",setup(w){S(),window.$=L;let a=g({});const b=g(null);let l=null,c=g(!1),q=g({productLoading:"",productChangeToCart:""});function x(){$.get("https://vue-course-api.hexschool.io/api/ozeu/cart").then(s=>{s.data.success&&(a.value=s.data.data,q.value.productChangeToCart="",j())})}function z(){l.show()}function T(){l.hide()}function C(o,s,_){let f=_||o.target.value;const e="https://vue-course-api.hexschool.io/api/ozeu/cart";let p=a.value.carts;c.value=!0,p.filter(v=>{console.log(v.product.id,s),v.product.id==s&&(M(v.id),o||(f=parseInt(v.qty)+parseInt(f)))}),$.post(e,{data:{product_id:s,qty:f}}).then(v=>{v.data.success&&x(),o||y.emit("cart:success",!0),c.value=!1})}function M(o){const s=`https://vue-course-api.hexschool.io/api/ozeu/cart/${o}`;$.delete(s).then(_=>{_.data.success&&x()})}function j(){y.emit("cart:returndata",a.value)}return D(()=>{l=new E(b.value),y.on("cart:change",o=>{let s=o[0],_=o[1];C(null,s,_)}),y.on("cart:delete",o=>{M(o)}),y.on("cart:init",(o=!1)=>{o?x():j()}),x()}),(o,s)=>{const _=k("loading"),f=k("router-link");return r(),i(N,null,[n(_,{active:d(c),"onUpdate:active":s[0]||(s[0]=e=>R(c)?c.value=e:c=e)},null,8,["active"]),d(a).carts?(r(),i("div",J,[t("div",K,[t("div",{class:"nav-link",onClick:z},[Q,t("span",Y,[u(h(d(a).carts.length)+" ",1),Z])])])])):U("",!0),t("div",{ref_key:"modalEle_cart",ref:b,class:"modal fade",id:"delProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[t("div",tt,[t("div",et,[ot,t("div",at,[t("table",st,[nt,t("tbody",null,[(r(!0),i(N,null,V(d(a).carts,e=>(r(),i("tr",lt,[t("td",ct,[t("button",{type:"button",class:"btn btn-danger btn-sm me-md-3 me-0",onClick:p=>(M(e.id),d(q).productChangeToCart=e.product.id)},[d(q).productChangeToCart==e.product.id?(r(),i("i",rt)):(r(),i("div",it,"X"))],8,dt)]),t("td",ut,[t("div",_t,[n(f,{to:`/page/${e.product.id}`,onClick:T},{default:m(()=>[u(h(e.product.title),1)]),_:2},1032,["to"])])]),t("td",pt,[t("button",{type:"button",class:"btn btn-primary rounded-0 rounded-start",disabled:e.qty<=1,onClick:p=>C(p,e.product.id,e.qty-1)},"-",8,ht),t("input",{type:"txt",class:"form-control rounded-0 addCartNum text-center",value:e.qty,onChange:p=>C(p,e.product.id)},null,40,mt),t("button",{type:"button",class:"btn btn-primary rounded-0 rounded-end",onClick:p=>C(p,e.product.id,e.qty+1)},"+",8,bt)]),t("td",ft,h(o.$currency.currencyUSD(e.product.price)),1),t("td",vt,h(o.$currency.currencyUSD(e.total)),1)]))),128))])]),gt,t("div",yt,[t("div",xt," 總計："+h(o.$currency.currencyUSD(d(a).final_total)),1)])]),t("div",Ct,[$t,n(f,{to:"/check/order_cart",type:"button",class:"btn btn-danger",onClick:T},{default:m(()=>[u("前往結帳")]),_:1})])])])],512)],64)}}},wt={class:"secCont footer"},qt=t("br",null,null,-1),Mt={__name:"footer",setup(w){let a=g(2024),b=g("HellWorld.io");return(l,c)=>(r(),i("footer",wt,[t("p",null,[u("建議使用edge或Chrome瀏覽器，以達最佳瀏覽效果。"),qt,u(" Copyright © "+h(d(a))+" "+h(d(b))+" All Rights Reserved.",1)])]))}},Nt={class:"main"},St={class:"nav-item mx-2"},Tt={class:"nav-item mx-2"},jt=t("li",{class:"nav-item mx-2"},[t("a",{class:"nav-link text-gold",href:"#"}," 購物需知 ")],-1),Dt=t("li",{class:"nav-item mx-2"},[t("a",{class:"nav-link text-gold",href:"#"}," 門市據點 ")],-1),Lt={class:"nav-item mx-2"},zt={class:"nav-item mx-2"},Et={__name:"page",setup(w){return S(),A(()=>{var a=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");$.defaults.headers.common.Authorization=a}),(a,b)=>{const l=k("router-link"),c=k("router-view");return r(),i(N,null,[t("div",Nt,[n(F),n(G,null,{default:m(()=>[t("li",St,[n(l,{class:"nav-link text-gold",to:"/shopping"},{default:m(()=>[u(" 商品資訊 ")]),_:1})]),t("li",Tt,[n(l,{class:"nav-link text-gold",to:"/brand"},{default:m(()=>[u(" 品牌介紹 ")]),_:1})]),jt,Dt,t("li",Lt,[n(l,{class:"nav-link text-gold",to:"/purchase"},{default:m(()=>[u(" 訂單查詢 ")]),_:1})]),t("li",zt,[n(l,{class:"nav-link text-gold",to:"/login"},{default:m(()=>[u(" 後台登入 ")]),_:1})])]),_:1}),n(kt),n(c)]),n(Mt)],64)}}};export{Et as default};
