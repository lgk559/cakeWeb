import{u as M,o as P,a as r,c as i,b as t,r as U,d as y,e as T,f as n,g as d,i as q,h as _,t as m,j as N,F as A,k as O,w as h,l as k,m as L}from"./index.js";import{M as B}from"./bootstrap.esm.js";import{$ as D}from"./jquery.js";import{e as C}from"./EventBus.js";import{_ as H}from"./AlertMessage2.js";const j={class:"fixed-top navbar navbar-dark navbar-expand-lg bg-brown text-gold"},F={class:"container-fluid justify-content-lg-center justify-content-md-between"},z=t("a",{class:"navbar-brand text-gold",href:"#"},"Navbar",-1),X=t("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),G={class:"collapse navbar-collapse flex-grow-0",id:"navbarSupportedContent"},J={class:"navbar-nav me-auto ps-3 mb-2 mb-lg-0"},K={__name:"Navbar_customer",setup(w){return M(),window.$=D,P(()=>{}),(o,f)=>(r(),i("nav",j,[t("div",F,[z,X,t("div",G,[t("ul",J,[U(o.$slots,"default")])])])]))}};var g={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Q={key:0,class:"d-flex text-gold position-fixed",id:"cart"},W={type:"button",class:"nav-iteme"},Y=t("i",{class:"fa-solid fa-cart-shopping"},null,-1),Z={class:"position-absolute start-100 translate-middle badge rounded-pill bg-danger"},tt=t("span",{class:"visually-hidden"},"unread messages",-1),et={class:"modal-dialog w-md-auto w-100 mx-sm-auto mx-0",role:"document"},at={class:"modal-content border-0"},ot=t("div",{class:"modal-header bg-custom text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"您目前的購物車品項")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),st={class:"modal-body"},nt={class:"table table-striped"},lt=t("thead",null,[t("tr",null,[t("td",{class:"col text-nowrap"},"管理"),t("td",{class:"col"},"品名"),t("td",{class:"col"},"數量"),t("td",{class:"col d-md-table-cell d-none"},"單價"),t("td",{class:"col d-md-table-cell d-none"},"小計")])],-1),ct={key:"item.id"},dt={class:"col"},rt=["onClick"],it={key:0,class:"fas fa-spinner fa-spin"},_t={key:1,class:"p"},ut={class:"col"},pt={class:"p omit-1"},mt={class:"col d-flex"},ht=["disabled","onClick"],ft=["value","onChange"],bt=["onClick"],vt={class:"col d-md-table-cell d-none"},gt={class:"col d-md-table-cell d-none"},yt=t("hr",null,null,-1),Ct={class:"row justify-content-end pe-3"},$t={class:"col-auto"},xt={class:"modal-footer"},kt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"繼續購買",-1),Tt={__name:"cart",setup(w){M(),window.$=D;let o=y({});const f=y(null);let l=null,c=y(!1),S=y({productLoading:"",productChangeToCart:""});function $(){const a=`${g.VITE_APIPATH}/api/${g.VITE_CUSTOMPATH}/cart`;k.get(a).then(s=>{s.data.success&&(o.value=s.data.data,S.value.productChangeToCart="",I())})}function R(){l.show()}function V(){l.hide()}function x(a,s,u){let b=u||a.target.value;const e=`${g.VITE_APIPATH}/api/${g.VITE_CUSTOMPATH}/cart`;let p=o.value.carts;c.value=!0,p.filter(v=>{console.log(v.product.id,s),v.product.id==s&&(E(v.id),a||(b=parseInt(v.qty)+parseInt(b)))}),k.post(e,{data:{product_id:s,qty:b}}).then(v=>{v.data.success&&$(),a||C.emit("cart:success",!0),c.value=!1})}function E(a){const s=`${g.VITE_APIPATH}/api/${g.VITE_CUSTOMPATH}/cart/${a}`;k.delete(s).then(u=>{u.data.success&&$()})}function I(){C.emit("cart:returndata",o.value)}return P(()=>{l=new B(f.value),C.on("cart:change",a=>{let s=a[0],u=a[1];x(null,s,u)}),C.on("cart:delete",a=>{E(a)}),C.on("cart:init",(a=!1)=>{a?$():I()}),$()}),(a,s)=>{const u=T("loading"),b=T("router-link");return r(),i(A,null,[n(u,{active:d(c),"onUpdate:active":s[0]||(s[0]=e=>q(c)?c.value=e:c=e)},null,8,["active"]),d(o).carts?(r(),i("div",Q,[t("div",W,[t("div",{class:"nav-link",onClick:R},[Y,t("span",Z,[_(m(d(o).carts.length)+" ",1),tt])])])])):N("",!0),t("div",{ref_key:"modalEle_cart",ref:f,class:"modal fade",id:"delProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[t("div",et,[t("div",at,[ot,t("div",st,[t("table",nt,[lt,t("tbody",null,[(r(!0),i(A,null,O(d(o).carts,e=>(r(),i("tr",ct,[t("td",dt,[t("button",{type:"button",class:"btn btn-danger btn-sm me-md-3 me-0",onClick:p=>(E(e.id),d(S).productChangeToCart=e.product.id)},[d(S).productChangeToCart==e.product.id?(r(),i("i",it)):(r(),i("div",_t,"X"))],8,rt)]),t("td",ut,[t("div",pt,[n(b,{to:`/page/${e.product.id}`,onClick:V},{default:h(()=>[_(m(e.product.title),1)]),_:2},1032,["to"])])]),t("td",mt,[t("button",{type:"button",class:"btn btn-primary rounded-0 rounded-start",disabled:e.qty<=1,onClick:p=>x(p,e.product.id,e.qty-1)},"-",8,ht),t("input",{type:"txt",class:"form-control rounded-0 addCartNum text-center",value:e.qty,onChange:p=>x(p,e.product.id)},null,40,ft),t("button",{type:"button",class:"btn btn-primary rounded-0 rounded-end",onClick:p=>x(p,e.product.id,e.qty+1)},"+",8,bt)]),t("td",vt,m(a.$currency.currencyUSD(e.product.price)),1),t("td",gt,m(a.$currency.currencyUSD(e.total)),1)]))),128))])]),yt,t("div",Ct,[t("div",$t," 總計："+m(a.$currency.currencyUSD(d(o).final_total)),1)])]),t("div",xt,[kt,n(b,{to:"/check/order_cart",type:"button",class:"btn btn-danger",onClick:V},{default:h(()=>[_("前往結帳")]),_:1})])])])],512)],64)}}};var wt={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const St={class:"secCont footer"},Et=t("br",null,null,-1),At={__name:"footer",setup(w){let o=y(2024),f=y(wt.VITE_company);return(l,c)=>(r(),i("footer",St,[t("p",null,[_("建議使用edge或Chrome瀏覽器，以達最佳瀏覽效果。"),Et,_(" Copyright © "+m(d(o))+" "+m(d(f))+" All Rights Reserved.",1)])]))}},Mt={class:"main"},Vt={class:"nav-item mx-2"},It={class:"nav-item mx-2"},Pt=t("li",{class:"nav-item mx-2"},[t("a",{class:"nav-link text-gold",href:"#"}," 購物需知 ")],-1),Dt=t("li",{class:"nav-item mx-2"},[t("a",{class:"nav-link text-gold",href:"#"}," 門市據點 ")],-1),Rt={class:"nav-item mx-2"},Ut={class:"nav-item mx-2"},Ht={__name:"page",setup(w){return M(),L(()=>{var o=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");k.defaults.headers.common.Authorization=o}),(o,f)=>{const l=T("router-link"),c=T("router-view");return r(),i(A,null,[t("div",Mt,[n(H),n(K,null,{default:h(()=>[t("li",Vt,[n(l,{class:"nav-link text-gold",to:"/shopping"},{default:h(()=>[_(" 商品資訊 ")]),_:1})]),t("li",It,[n(l,{class:"nav-link text-gold",to:"/brand"},{default:h(()=>[_(" 品牌介紹 ")]),_:1})]),Pt,Dt,t("li",Rt,[n(l,{class:"nav-link text-gold",to:"/purchase"},{default:h(()=>[_(" 訂單查詢 ")]),_:1})]),t("li",Ut,[n(l,{class:"nav-link text-gold",to:"/login"},{default:h(()=>[_(" 後台登入 ")]),_:1})])]),_:1}),n(Tt),n(c)]),n(At)],64)}}};export{Ht as default};
