import{I as B,d as p,o as I,e as T,a as n,c as a,f as b,g as l,i as N,b as t,F as $,k as q,t as _,w as g,B as D,C as M,J as j,l as A,j as S,A as U,h as x}from"./index.js";import{e as m}from"./EventBus.js";import{M as P}from"./bootstrap.esm.js";import{$ as O}from"./jquery.js";var V={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const z={key:0,class:"check_cart"},F=t("li",null,[t("div",{class:"check_cart-header py-2 border-bottom bg-brown text-gold"}," 訂單名細 ")],-1),H={key:"item.id",class:"d-flex align-items-center flex-wrap p-md-3 p-2"},J=["onClick"],X={class:"col-auto img"},G=["src"],K={class:"col-12 p omit-1 w-100 px-md-5 px-3 py-md-3 py-2"},W={class:"info d-flex align-items-center flex-wrap px-md-5 px-md-0 px-2"},Y={class:"col-md-auto col-6"},Z={class:"col d-flex"},Q=["disabled","onClick"],tt=["value","onChange"],et=["onClick"],ot={class:"col-md-auto col-6 ps-md-3 ps-0"},st={class:"col-md-auto col-6 ms-md-0 ms-auto ps-md-3 ps-0"},lt=["onClick"],nt={key:0,class:"fas fa-spinner fa-spin"},at={key:1,class:"p py-1 px-2"},dt={id:"coupon",class:"d-flex flex-wrap justify-content-center p-2 bg-brown text-gold"},ct={class:"col-md-7 col-12 d-flex align-items-center"},it=t("span",{class:"col-auto me-3"},"優惠券",-1),rt={class:"col-md-7 col-12 d-flex py-2"},ut={class:"col-6 d-flex flex-wrap"},pt={class:"col-md-6 col-12"},_t={class:"col-md-6 col-12"},mt={class:"col-md-auto col-6 flex-grow-1"},vt={key:1,class:"row justify-content-center align-items-center text-center p-5"},ft=t("h1",null,"空",-1),bt=t("p",null,"您的購物車內尚無商品哦！",-1),ht={class:"modal-dialog w-md-auto w-100 mx-sm-auto mx-0",role:"document"},gt={class:"modal-content border-0"},xt=t("div",{class:"modal-header"},[t("h5",{class:"m-0 modal-title",id:"exampleModalLabel"}," 選擇優惠券或輸入優惠代碼 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),yt={class:"modal-body"},Ct=t("div",{class:"input-group mb-3"},[t("input",{type:"text",class:"form-control",placeholder:"請輸入優惠代碼","aria-label":"Recipient's username","aria-describedby":"button-addon2"}),t("button",{class:"btn btn-brown",type:"button",id:"button-addon2"},"送出")],-1),wt=t("hr",null,null,-1),kt=t("p",{class:"fw-bold"},"選擇優惠券",-1),Tt={class:"mb-0 me-auto"},$t={class:"d-flex mb-3"},Dt={class:"col-1 d-flex justify-content-center align-item-center"},Mt=j('<div class="col-11 d-flex border"><div class="col-2 d-flex align-items-center justify-content-center bg-brown text-gold text-center h5 p-1 h-100 me-2"> 15% off </div><div class="col-10 d-flex flex-wrap align-item-center p-2"><p class="col-12 m-0">年終感恩祭</p><div class="col-8 p"> 使用期限：<span>10/01~2/28</span></div><div class="col-4 p"> 使用規則 </div></div></div>',1),St={class:"d-flex mb-3"},Ut={class:"col-1 d-flex justify-content-center align-item-center"},Vt=j('<div class="col-11 d-flex border"><div class="col-2 d-flex align-items-center justify-content-center bg-brown text-gold text-center h5 p-1 h-100 me-2"> 10% off </div><div class="col-10 d-flex flex-wrap align-item-center p-2"><p class="col-12 m-0">金牌會員</p><div class="col-8 p"> 使用期限：<span>永久</span></div><div class="col-4 p"> 使用規則 </div></div></div>',1),It={__name:"check_cart",setup(jt){B(),window.$=O;const v=p({});let y=p(0);const C=p(null);let w=null,i=p(!1),d=p({productLoading:"",productChangeToCart:""}),c=p({code:null,title:""});function k(o=!1){m.emit("cart:init",o)}function h(o,s,f){let r;typeof f!="number"?r=f.target.value-s:r=f,m.emit("cart:change",[o,r])}function E(o){m.emit("cart:delete",o)}function L(){w.show()}function R(){i.value=!0;const o=`${V.VITE_APIPATH}/api/${V.VITE_CUSTOMPATH}/coupon`;A.post(o,{data:{code:c.value.code}}).then(s=>{s.data.success?(k(!0),i.value=!1):(i.value=!1,m.emit("message:push",s.data.message,"warning"))})}return I(()=>{w=new P(C.value),m.on("cart:change",o=>{o[0],o[1]}),m.on("cart:returndata",o=>{v.value=o,y.value=o.carts.length}),k()}),(o,s)=>{const f=T("loading"),r=T("router-link");return n(),a($,null,[b(f,{active:l(i),"onUpdate:active":s[0]||(s[0]=e=>N(i)?i.value=e:i=e)},null,8,["active"]),l(y)!=0?(n(),a("div",z,[t("ul",null,[F,(n(!0),a($,null,q(v.value.carts,e=>(n(),a("li",H,[l(d).productChangeToCart!=e.id?(n(),a("div",{key:0,style:{"z-index":"1"},class:"position-absolute top-0 end-0 d-md-none d-block text-secondary border-0 py-2 px-3",onClick:u=>l(d).productChangeToCart=e.id}," 管理 ",8,J)):S("",!0),l(d).productChangeToCart==e.id?(n(),a("div",{key:1,style:{"z-index":"1"},class:"position-absolute top-0 end-0 d-md-none d-block text-secondary border-0 py-2 px-3",onClick:s[1]||(s[1]=u=>l(d).productChangeToCart="")}," 取消 ")):S("",!0),t("div",X,[t("img",{class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,G)]),t("div",{class:U(["col d-flex flex-wrap side-right",{active:e.id==l(d).productChangeToCart}])},[t("div",K,[b(r,{class:"text-brown",to:`/page/${e.product.id}`},{default:g(()=>[x(_(e.product.title),1)]),_:2},1032,["to"])]),t("ul",W,[t("li",Y,[t("div",Z,[t("button",{type:"button",class:"btn btn-brown rounded-0 rounded-start py-1 px-2",disabled:e.qty<=1,onClick:u=>h(e.product.id,e.qty,parseInt(-1))},"-",8,Q),t("input",{type:"txt",class:"form-control rounded-0 addCartNum text-center p-1",value:e.qty,onChange:u=>h(e.product.id,e.qty,u)},null,40,tt),t("button",{type:"button",class:"btn btn-brown rounded-0 rounded-end py-1 px-2",onClick:u=>h(e.product.id,e.qty,parseInt(1))},"+",8,et)])]),t("li",ot," 單價："+_(o.$currency.currencyUSD(e.product.price)),1),t("li",st," 小計："+_(o.$currency.currencyUSD(e.total)),1)])],2),t("div",{class:U(["control",{active:e.id==l(d).productChangeToCart}])},[t("div",{class:"h-100 me-md-3 me-0 d-flex align-items-center justify-content-center",onClick:u=>(E(e.id),l(d).productChangeToCart=e.product.id)},[l(d).productChangeToCart==e.product.id?(n(),a("i",nt)):(n(),a("div",at,"X"))],8,lt)],2)]))),128))]),t("div",dt,[t("div",ct,[it,t("div",{class:"openDiscountBtn",onClick:L},_(l(c).title||"選擇優惠券或輸入優惠代碼"),1)]),t("div",rt,[t("div",ut,[t("div",pt," 折扣：- "+_(o.$currency.currencyUSD(v.value.total-v.value.final_total)),1),t("div",_t," 需付金額： "+_(o.$currency.currencyUSD(v.value.final_total)),1)]),t("div",mt,[b(r,{to:"/check/order_check",type:"button",class:"btn btn-gold btn-sm ml-auto w-100"},{default:g(()=>[x(" 結帳 ")]),_:1})])])])])):(n(),a("div",vt,[ft,bt,b(r,{to:"/shopping",class:"btn btn-outline-brown w-auto"},{default:g(()=>[x("去逛逛")]),_:1})])),t("div",{ref_key:"modalEle_discount",ref:C,class:"modal fade",id:"delProductModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[t("div",ht,[t("div",gt,[xt,t("div",yt,[Ct,wt,kt,t("ul",Tt,[t("li",$t,[t("div",Dt,[D(t("input",{type:"radio",name:"",id:"",value:"520","onUpdate:modelValue":s[2]||(s[2]=e=>l(c).code=e),onClick:s[3]||(s[3]=e=>l(c).title="年終感恩祭")},null,512),[[M,l(c).code]])]),Mt]),t("li",St,[t("div",Ut,[D(t("input",{type:"radio",name:"",id:"",value:"999","onUpdate:modelValue":s[4]||(s[4]=e=>l(c).code=e),onClick:s[5]||(s[5]=e=>l(c).title="金牌會員")},null,512),[[M,l(c).code]])]),Vt])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-brown w-100","data-bs-dismiss":"modal",onClick:R},"確認選取")])])])],512)],64)}}};export{It as default};
